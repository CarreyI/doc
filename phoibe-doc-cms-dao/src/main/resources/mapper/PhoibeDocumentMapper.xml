<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="me.phoibe.doc.cms.dao.PhoibeDocumentMapper">
  <resultMap id="BaseResultMap" type="me.phoibe.doc.cms.domain.po.PhoibeDocument">
    <id column="ID" jdbcType="DECIMAL" property="id" />
    <result column="NAME" jdbcType="VARCHAR" property="name" />
    <result column="FORMAT" jdbcType="VARCHAR" property="format" />
    <result column="USER_ID" jdbcType="DECIMAL" property="userId" />
    <result column="SCORE" jdbcType="DECIMAL" property="score" />
    <result column="FILE_PATH" jdbcType="VARCHAR" property="filePath" />
    <result column="FILE_SIZE" jdbcType="DECIMAL" property="fileSize" />

    <!-- <result column="COMBAT_TYPE" jdbcType="DECIMAL" property="combatType" />-->
    <result column="ARMS" jdbcType="DECIMAL" property="arms" />
    <result column="STATUS" jdbcType="DECIMAL" property="status" />
    <result column="AUDIT_STATUS" jdbcType="DECIMAL" property="auditStatus" />
    <result column="AUDIT_USER_ID" jdbcType="DECIMAL" property="auditUserId" />
    <result column="AUDITOR" jdbcType="VARCHAR" property="auditor" />
    <result column="AUDITDESC" jdbcType="VARCHAR" property="auditDesc" />
    <result column="PROGRESS" jdbcType="DECIMAL" property="progress" />
    <result column="TAG" jdbcType="VARCHAR" property="tag" />
    <result column="DESCRIPTION" jdbcType="VARCHAR" property="description" />
    <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
    <result column="UPDATE_TIME" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="PAGECOUNT" jdbcType="DECIMAL" property="pagecount" />
    <result column="HITCOUNT" jdbcType="DECIMAL" property="hitcount" />
    <result column="RECORDER" jdbcType="DECIMAL" property="recorder" />
    <result column="AUDIT_TIME" jdbcType="TIMESTAMP" property="auditTime" />
    <result column="ISSTOCK" jdbcType="DECIMAL" property="isstock" />
    <result column="STOCK_TIME" jdbcType="TIMESTAMP" property="stockTime" />
    <result column="STOCKER" jdbcType="VARCHAR" property="stocker" />
    <result column="USER_REAL_NAME" jdbcType="VARCHAR" property="userRealName" />
    <result column="WARADDR" jdbcType="VARCHAR" property="waraddr" />
    <result column="WARTIME" jdbcType="TIMESTAMP" property="wartime" />
    <result column="WINNER" jdbcType="VARCHAR" property="winner" />
    <result column="LOSER" jdbcType="VARCHAR" property="loser" />
    <result column="WARNUM" jdbcType="VARCHAR" property="warnum" />
    <result column="WARSTATE" jdbcType="VARCHAR" property="warstate" />
    <!-- 新增字段 战例类型-->
    <result column="WARSTYPE" jdbcType="VARCHAR" property="warstype"/>
    <!--新增字段 兵种类型-->
    <result column="CORPSTYPE" jdbcType="VARCHAR" property="corpstype"/>
    <!--新增字段 作战年代-->
    <result column="FIGHTTIME" jdbcType="VARCHAR" property="fightTime"/>
    <!--新增字段 作战类别 -->
    <result column="FIGHTTYPE" jdbcType="VARCHAR" property="fighttype"/>
    <!--战斗种类-->
    <result column="COMBATTYPE" jdbcType="VARCHAR" property="combattypestring"/>
    <!--作战特点-->
    <result column="FIGHTTRAIT" jdbcType="VARCHAR" property="fighttrait"/>
    <!--文档类型-->
    <result column="DOCTYPE" jdbcType="DECIMAL" property="docType"/>
  </resultMap>
  <resultMap extends="BaseResultMap" id="ResultMapWithBLOBs" type="me.phoibe.doc.cms.domain.po.PhoibeDocument">
      <!--<result column="CONTENT" jdbcType="BLOB" property="content" />-->
    <result column="NICKNAME" jdbcType="VARCHAR" property="nickname" />
  </resultMap>
    <resultMap extends="ResultMapWithBLOBs" id="ResultMapUser" type="me.phoibe.doc.cms.domain.dto.DPhoebeDocument">
        <result column="REALNAME" jdbcType="VARCHAR" property="realname" />
        <result column="NICKNAME" jdbcType="VARCHAR" property="nickname" />
    </resultMap>
  <sql id="Base_Column_List">
    ID, NAME, FORMAT, USER_ID, SCORE, FILE_PATH, FILE_SIZE, COMBAT_TYPE , ARMS, STATUS,
    AUDIT_STATUS, AUDIT_USER_ID, PROGRESS, TAG, DESCRIPTION, CREATE_TIME, UPDATE_TIME, 
    PAGECOUNT, HITCOUNT, RECORDER, AUDIT_TIME, ISSTOCK, STOCK_TIME, STOCKER, USER_REAL_NAME, 
    WARADDR, WARTIME, WINNER, LOSER, WARNUM, WARSTATE,WARSTYPE,CORPSTYPE,FIGHTTIME,FIGHTTYPE,COMBATTYPE,FIGHTTRAIT,DOCTYPE,AUDITOR,AUDITDESC
  </sql>
  <!--<sql id="Blob_Column_List">
    CONTENT
  </sql>-->
  <select id="selectByPrimaryKey" parameterType="java.lang.Long"  resultMap="ResultMapUser">
    select d.ID,d.NAME,d.FORMAT,d.USER_ID,d.SCORE,d.FILE_PATH,d.FILE_SIZE,d.COMBAT_TYPE,d.ARMS,
      d.STATUS,d.AUDIT_STATUS,d.AUDIT_USER_ID,d.PROGRESS,d.TAG,d.DESCRIPTION,d.CREATE_TIME,d.UPDATE_TIME,
      d.PAGECOUNT,d.HITCOUNT,d.RECORDER,d.AUDIT_TIME,d.ISSTOCK,d.STOCK_TIME,d.STOCKER,d.USER_REAL_NAME,d.WARADDR,d.WARTIME,d.WINNER,d.LOSER,d.WARNUM,d.WARSTATE,
      u.REALNAME,u.NICKNAME,d.WARSTYPE,d.CORPSTYPE,d.FIGHTTIME,d.FIGHTTYPE,d.COMBATTYPE,d.FIGHTTRAIT,d.DOCTYPE
    from PHOIBE_DOCUMENT d JOIN PHOIBE_USER u ON d.USER_ID = u.ID
    where d.ID = #{id,jdbcType=DECIMAL}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    delete from PHOIBE_DOCUMENT d
    where ID = #{id,jdbcType=DECIMAL}
  </delete>
  <insert id="insert" parameterType="me.phoibe.doc.cms.domain.po.PhoibeDocument" useGeneratedKeys="true" keyColumn="id" keyProperty="id">
    insert into PHOIBE_DOCUMENT (ID, NAME, FORMAT, 
      USER_ID, SCORE, FILE_PATH, 
      FILE_SIZE, ARMS,
      STATUS, AUDIT_STATUS, AUDIT_USER_ID, 
      PROGRESS, TAG, DESCRIPTION, 
      CREATE_TIME, UPDATE_TIME, PAGECOUNT, 
      HITCOUNT, RECORDER, AUDIT_TIME, 
      ISSTOCK, STOCK_TIME, STOCKER, 
      USER_REAL_NAME, WARADDR, WARTIME, 
      WINNER, LOSER, WARNUM, 
      WARSTATE,WARSTYPE,CORPSTYPE,FIGHTTIME,FIGHTTYPE,COMBATTYPE,FIGHTTRAIT,DOCTYPE)
    values (#{id,jdbcType=DECIMAL}, #{name,jdbcType=VARCHAR}, #{format,jdbcType=VARCHAR}, 
      #{userId,jdbcType=DECIMAL}, #{score,jdbcType=DECIMAL}, #{filePath,jdbcType=VARCHAR}, 
      #{fileSize,jdbcType=DECIMAL}, #{arms,jdbcType=DECIMAL},
      #{status,jdbcType=DECIMAL}, #{auditStatus,jdbcType=DECIMAL}, #{auditUserId,jdbcType=DECIMAL}, 
      #{progress,jdbcType=DECIMAL}, #{tag,jdbcType=VARCHAR}, #{description,jdbcType=VARCHAR}, 
      #{createTime,jdbcType=TIMESTAMP}, #{updateTime,jdbcType=TIMESTAMP}, #{pagecount,jdbcType=DECIMAL}, 
      #{hitcount,jdbcType=DECIMAL}, #{recorder,jdbcType=DECIMAL}, #{auditTime,jdbcType=TIMESTAMP}, 
      #{isstock,jdbcType=DECIMAL}, #{stockTime,jdbcType=TIMESTAMP}, #{stocker,jdbcType=VARCHAR}, 
      #{userRealName,jdbcType=VARCHAR}, #{waraddr,jdbcType=VARCHAR}, #{wartime,jdbcType=TIMESTAMP}, 
      #{winner,jdbcType=VARCHAR}, #{loser,jdbcType=VARCHAR}, #{warnum,jdbcType=VARCHAR}, 
      #{warstate,jdbcType=VARCHAR},#{warstype,jdbcType=VARCHAR},
      #{corpstype,jdbcType=VARCHAR},#{fightTime,jdbcType=VARCHAR},#{fighttype,jdbcType=VARCHAR},
      #{combattypestring,jdbcType=VARCHAR},#{fighttrait,jdbcType=VARCHAR},#{docType,jdbcType=DECIMAL})
  </insert>
  <insert id="insertSelective" parameterType="me.phoibe.doc.cms.domain.po.PhoibeDocument">
    insert into PHOIBE_DOCUMENT
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        ID,
      </if>
      <if test="name != null">
        NAME,
      </if>
      <if test="format != null">
        FORMAT,
      </if>
      <if test="userId != null">
        USER_ID,
      </if>
      <if test="score != null">
        SCORE,
      </if>
      <if test="filePath != null">
        FILE_PATH,
      </if>
      <if test="fileSize != null">
        FILE_SIZE,
      </if>
      <!--<if test="combatType != null">
        COMBAT_TYPE,
      </if>-->
      <if test="arms != null">
        ARMS,
      </if>
      <if test="status != null">
        STATUS,
      </if>
      <if test="auditStatus != null">
        AUDIT_STATUS,
      </if>
      <if test="auditUserId != null">
        AUDIT_USER_ID,
      </if>
      <if test="progress != null">
        PROGRESS,
      </if>
      <if test="tag != null">
        TAG,
      </if>
      <if test="description != null">
        DESCRIPTION,
      </if>
      <if test="createTime != null">
        CREATE_TIME,
      </if>
      <if test="updateTime != null">
        UPDATE_TIME,
      </if>
      <if test="pagecount != null">
        PAGECOUNT,
      </if>
      <if test="hitcount != null">
        HITCOUNT,
      </if>
      <if test="recorder != null">
        RECORDER,
      </if>
      <if test="auditTime != null">
        AUDIT_TIME,
      </if>
      <if test="isstock != null">
        ISSTOCK,
      </if>
      <if test="stockTime != null">
        STOCK_TIME,
      </if>
      <if test="stocker != null">
        STOCKER,
      </if>
      <if test="userRealName != null">
        USER_REAL_NAME,
      </if>
      <if test="waraddr != null">
        WARADDR,
      </if>
      <if test="wartime != null">
        WARTIME,
      </if>
      <if test="winner != null">
        WINNER,
      </if>
      <if test="loser != null">
        LOSER,
      </if>
      <if test="warnum != null">
        WARNUM,
      </if>
      <if test="warstate != null">
        WARSTATE,
      </if>
      <!--<if test="content != null">
        CONTENT,
      </if>-->
      <if test="warstype != null">
        WARSTYPE,
      </if>
      <if test="corpsTypeString != null">
        CORPSYTPE,
      </if>
      <if test="fightTime != null">
        FIGHTTIME,
      </if>
      <if test="fighttype != null">
        FIGHTTYPE,
      </if>
      <if test="combattypestring != null">
        COMBATTYPE,
      </if>
      <if test="fighttrait != null">
        FIGHTTRAIT,
      </if>
      <if test="docType != null">
        DOCTYPE
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=DECIMAL},
      </if>
      <if test="name != null">
        #{name,jdbcType=VARCHAR},
      </if>
      <if test="format != null">
        #{format,jdbcType=VARCHAR},
      </if>
      <if test="userId != null">
        #{userId,jdbcType=DECIMAL},
      </if>
      <if test="score != null">
        #{score,jdbcType=DECIMAL},
      </if>
      <if test="filePath != null">
        #{filePath,jdbcType=VARCHAR},
      </if>
      <if test="fileSize != null">
        #{fileSize,jdbcType=DECIMAL},
      </if>
      <!--<if test="combatType != null">
        #{combatType,jdbcType=DECIMAL},
      </if>-->
      <if test="arms != null">
        #{arms,jdbcType=DECIMAL},
      </if>
      <if test="status != null">
        #{status,jdbcType=DECIMAL},
      </if>
      <if test="auditStatus != null">
        #{auditStatus,jdbcType=DECIMAL},
      </if>
      <if test="auditUserId != null">
        #{auditUserId,jdbcType=DECIMAL},
      </if>
      <if test="progress != null">
        #{progress,jdbcType=DECIMAL},
      </if>
      <if test="tag != null">
        #{tag,jdbcType=VARCHAR},
      </if>
      <if test="description != null">
        #{description,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="pagecount != null">
        #{pagecount,jdbcType=DECIMAL},
      </if>
      <if test="hitcount != null">
        #{hitcount,jdbcType=DECIMAL},
      </if>
      <if test="recorder != null">
        #{recorder,jdbcType=DECIMAL},
      </if>
      <if test="auditTime != null">
        #{auditTime,jdbcType=TIMESTAMP},
      </if>
      <if test="isstock != null">
        #{isstock,jdbcType=DECIMAL},
      </if>
      <if test="stockTime != null">
        #{stockTime,jdbcType=TIMESTAMP},
      </if>
      <if test="stocker != null">
        #{stocker,jdbcType=VARCHAR},
      </if>
      <if test="userRealName != null">
        #{userRealName,jdbcType=VARCHAR},
      </if>
      <if test="waraddr != null">
        #{waraddr,jdbcType=VARCHAR},
      </if>
      <if test="wartime != null">
        #{wartime,jdbcType=TIMESTAMP},
      </if>
      <if test="winner != null">
        #{winner,jdbcType=VARCHAR},
      </if>
      <if test="loser != null">
        #{loser,jdbcType=VARCHAR},
      </if>
      <if test="warnum != null">
        #{warnum,jdbcType=VARCHAR},
      </if>
      <if test="warstate != null">
        #{warstate,jdbcType=VARCHAR},
      </if>
      <!--<if test="content != null">
        #{content,jdbcType=BLOB},
      </if>-->
      <if test="warstype !=null ">
        #{warstype,jdbcType=VARCHAR},
      </if>
      <if test="corpstype !=null ">
        #{corpstype,jdbcType=VARCHAR},
      </if>
      <if test="fightTime !=null ">
        #{fightTime,jdbcType=VARCHAR},
      </if>
      <if test="fighttype !=null ">
        #{fighttype,jdbcType=VARCHAR},
      </if>
      <if test="combattypestring !=null ">
        #{combattypestring,jdbcType=VARCHAR},
      </if>
      <if test="fighttrait !=null ">
       #{fighttrait,jdbcType=VARCHAR},
      </if>
      <if test="docType !=null ">
        #{docType,jdbcType=DECIMAL}
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="me.phoibe.doc.cms.domain.po.PhoibeDocument">
    update PHOIBE_DOCUMENT
    <set>
      <if test="name != null">
        NAME = #{name,jdbcType=VARCHAR},
      </if>
      <if test="format != null">
        FORMAT = #{format,jdbcType=VARCHAR},
      </if>
      <if test="userId != null">
        USER_ID = #{userId,jdbcType=DECIMAL},
      </if>
      <if test="score != null">
        SCORE = #{score,jdbcType=DECIMAL},
      </if>
      <if test="filePath != null">
        FILE_PATH = #{filePath,jdbcType=VARCHAR},
      </if>
      <if test="fileSize != null">
        FILE_SIZE = #{fileSize,jdbcType=DECIMAL},
      </if>
      <!--<if test="combatType != null">
        COMBAT_TYPE = #{combatType,jdbcType=DECIMAL},
      </if>-->
      <if test="arms != null">
        ARMS = #{arms,jdbcType=DECIMAL},
      </if>
      <if test="status != null">
        STATUS = #{status,jdbcType=DECIMAL},
      </if>
      <if test="auditStatus != null">
        AUDIT_STATUS = #{auditStatus,jdbcType=DECIMAL},
      </if>
      <if test="auditor!=null">
        AUDITOR = #{auditor,jdbcType=VARCHAR},
      </if>
      <if test="auditDesc!=null">
        AUDITDESC = #{auditDesc,jdbcType=VARCHAR},
      </if>
      <if test="auditUserId != null">
        AUDIT_USER_ID = #{auditUserId,jdbcType=DECIMAL},
      </if>
      <if test="progress != null">
        PROGRESS = #{progress,jdbcType=DECIMAL},
      </if>
      <if test="tag != null">
        TAG = #{tag,jdbcType=VARCHAR},
      </if>
      <if test="description != null">
        DESCRIPTION = #{description,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateTime != null">
        UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="pagecount != null">
        PAGECOUNT = #{pagecount,jdbcType=DECIMAL},
      </if>
      <if test="hitcount != null">
        HITCOUNT = #{hitcount,jdbcType=DECIMAL},
      </if>
      <if test="recorder != null">
        RECORDER = #{recorder,jdbcType=DECIMAL},
      </if>
      <if test="auditTime != null">
        AUDIT_TIME = #{auditTime,jdbcType=TIMESTAMP},
      </if>
      <if test="isstock != null">
        ISSTOCK = #{isstock,jdbcType=DECIMAL},
      </if>
      <if test="stockTime != null">
        STOCK_TIME = #{stockTime,jdbcType=TIMESTAMP},
      </if>
      <if test="stocker != null">
        STOCKER = #{stocker,jdbcType=VARCHAR},
      </if>
      <if test="userRealName != null">
        USER_REAL_NAME = #{userRealName,jdbcType=VARCHAR},
      </if>
      <if test="waraddr != null">
        WARADDR = #{waraddr,jdbcType=VARCHAR},
      </if>
      <if test="wartime != null">
        WARTIME = #{wartime,jdbcType=TIMESTAMP},
      </if>
      <if test="winner != null">
        WINNER = #{winner,jdbcType=VARCHAR},
      </if>
      <if test="loser != null">
        LOSER = #{loser,jdbcType=VARCHAR},
      </if>
      <if test="warnum != null">
        WARNUM = #{warnum,jdbcType=VARCHAR},
      </if>
      <if test="warstate != null">
        WARSTATE = #{warstate,jdbcType=VARCHAR},
      </if>
      <!--<if test="content != null">
        CONTENT = #{content,jdbcType=BLOB},
      </if>-->
      <if test="warstype !=null ">
        WARSTYPE = #{warstype,jdbcType=VARCHAR},
      </if>
      <if test="corpstype !=null ">
        CORPSTYPE = #{corpstype,jdbcType=VARCHAR},
      </if>
      <if test="fightTime !=null ">
        FIGHTTIME = #{fightTime,jdbcType=VARCHAR},
      </if>
      <if test="fighttype !=null ">
        FIGHTTYPE = #{fighttype,jdbcType=VARCHAR},
      </if>
      <if test="combattypestring !=null ">
        COMBATTYPE = #{combattypestring,jdbcType=VARCHAR},
      </if>
      <if test="fighttrait !=null ">
        FIGHTTRAIT = #{fighttrait,jdbcType=VARCHAR},
      </if>
      <if test="docType !=null ">
        DOCTYPE = #{docType,jdbcType=DECIMAL}
      </if>
    </set>
    where ID = #{id,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="me.phoibe.doc.cms.domain.po.PhoibeDocument">
    update PHOIBE_DOCUMENT
    set NAME = #{name,jdbcType=VARCHAR},
      FORMAT = #{format,jdbcType=VARCHAR},
      USER_ID = #{userId,jdbcType=DECIMAL},
      SCORE = #{score,jdbcType=DECIMAL},
      FILE_PATH = #{filePath,jdbcType=VARCHAR},
      FILE_SIZE = #{fileSize,jdbcType=DECIMAL},
      <!--COMBAT_TYPE = #{combatType,jdbcType=DECIMAL},-->
      ARMS = #{arms,jdbcType=DECIMAL},
      STATUS = #{status,jdbcType=DECIMAL},
      AUDIT_STATUS = #{auditStatus,jdbcType=DECIMAL},
      AUDIT_USER_ID = #{auditUserId,jdbcType=DECIMAL},
      PROGRESS = #{progress,jdbcType=DECIMAL},
      TAG = #{tag,jdbcType=VARCHAR},
      DESCRIPTION = #{description,jdbcType=VARCHAR},
      CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      PAGECOUNT = #{pagecount,jdbcType=DECIMAL},
      HITCOUNT = #{hitcount,jdbcType=DECIMAL},
      RECORDER = #{recorder,jdbcType=DECIMAL},
      AUDIT_TIME = #{auditTime,jdbcType=TIMESTAMP},
      ISSTOCK = #{isstock,jdbcType=DECIMAL},
      STOCK_TIME = #{stockTime,jdbcType=TIMESTAMP},
      STOCKER = #{stocker,jdbcType=VARCHAR},
      USER_REAL_NAME = #{userRealName,jdbcType=VARCHAR},
      WARADDR = #{waraddr,jdbcType=VARCHAR},
      WARTIME = #{wartime,jdbcType=TIMESTAMP},
      WINNER = #{winner,jdbcType=VARCHAR},
      LOSER = #{loser,jdbcType=VARCHAR},
      WARNUM = #{warnum,jdbcType=VARCHAR},
      WARSTATE = #{warstate,jdbcType=VARCHAR},
      <!--CONTENT = #{content,jdbcType=BLOB},-->
      WARSTYPE = #{warstype,jdbcType=VARCHAR},
      CORPSTYPE = #{corpstype,jdbcType=VARCHAR},
      FIGHTTIME = #{fightTime,jdbcType=VARCHAR},
      FIGHTTYPE = #{fighttype,jdbcType=VARCHAR},
      COMBATTYPE = #{combattypestring,jdbcType=VARCHAR},
      FIGHTTRAIT = #{fighttrait,jdbcType=VARCHAR},
      DOCTYPE = #{docType,jdbcType=DECIMAL}
    where ID = #{id,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="me.phoibe.doc.cms.domain.po.PhoibeDocument">
    update PHOIBE_DOCUMENT
    set NAME = #{name,jdbcType=VARCHAR},
      FORMAT = #{format,jdbcType=VARCHAR},
      USER_ID = #{userId,jdbcType=DECIMAL},
      SCORE = #{score,jdbcType=DECIMAL},
      FILE_PATH = #{filePath,jdbcType=VARCHAR},
      FILE_SIZE = #{fileSize,jdbcType=DECIMAL},
     <!-- COMBAT_TYPE = #{combatType,jdbcType=DECIMAL},-->
      ARMS = #{arms,jdbcType=DECIMAL},
      STATUS = #{status,jdbcType=DECIMAL},
      AUDIT_STATUS = #{auditStatus,jdbcType=DECIMAL},
      AUDIT_USER_ID = #{auditUserId,jdbcType=DECIMAL},
      PROGRESS = #{progress,jdbcType=DECIMAL},
      TAG = #{tag,jdbcType=VARCHAR},
      DESCRIPTION = #{description,jdbcType=VARCHAR},
      CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      UPDATE_TIME = #{updateTime,jdbcType=TIMESTAMP},
      PAGECOUNT = #{pagecount,jdbcType=DECIMAL},
      HITCOUNT = #{hitcount,jdbcType=DECIMAL},
      RECORDER = #{recorder,jdbcType=DECIMAL},
      AUDIT_TIME = #{auditTime,jdbcType=TIMESTAMP},
      ISSTOCK = #{isstock,jdbcType=DECIMAL},
      STOCK_TIME = #{stockTime,jdbcType=TIMESTAMP},
      STOCKER = #{stocker,jdbcType=VARCHAR},
      USER_REAL_NAME = #{userRealName,jdbcType=VARCHAR},
      WARADDR = #{waraddr,jdbcType=VARCHAR},
      WARTIME = #{wartime,jdbcType=TIMESTAMP},
      WINNER = #{winner,jdbcType=VARCHAR},
      LOSER = #{loser,jdbcType=VARCHAR},
      WARNUM = #{warnum,jdbcType=VARCHAR},
      WARSTATE = #{warstate,jdbcType=VARCHAR},
      WARSTYPE = #{warstype,jdbcType=VARCHAR},
      CORPSTYPE = #{corpstype,jdbcType=VARCHAR},
      FIGHTTIME = #{fightTime,jdbcType=VARCHAR},
      FIGHTTYPE = #{fighttype,jdbcType=VARCHAR},
      COMBATTYPE = #{combattypestring,jdbcType=VARCHAR},
      FIGHTTRAIT = #{fighttrait,jdbcType=VARCHAR},
      DOCTYPE = #{docType,jdbcType=DECIMAL}
    where ID = #{id,jdbcType=DECIMAL}
  </update>
  <sql id="selectByPage_Condition_Sql">
    <where>
      1=1
      <if test="param.name != null and param.name != ''">
        and NAME LIKE '%'||#{param.name,jdbcType=VARCHAR}||'%'
      </if>
      <if test="param.description != null and param.description != ''">
        and DESCRIPTION LIKE '%'||#{param.description,jdbcType=VARCHAR}||'%'
      </if>
      <if test="param.userId != null and param.userId != ''">
        and USER_ID = #{param.userId,jdbcType=DECIMAL}
      </if>
      <if test="param.format != null and param.format != ''">
        and FORMAT = #{param.format,jdbcType=VARCHAR}
      </if>
      <if test="param.userRealName != null and param.userRealName != ''">
        and USER_REAL_NAME Like '%'||#{param.userRealName,jdbcType=VARCHAR}||'%'
      </if>
      <if test="param.score != null and param.score != ''">
        and SCORE = #{param.score,jdbcType=DECIMAL}
      </if>
      <if test="param.status != null and param.status != ''">
        and d.STATUS = #{param.status,jdbcType=DECIMAL}
      </if>
      <if test="param.auditStatus != null and param.auditStatus != '' and param.auditStatus==1">
        and AUDIT_STATUS = #{param.auditStatus,jdbcType=DECIMAL}
      </if>
      <if test="param.auditStatus != null and param.auditStatus != '' and param.auditStatus>1">
        and (AUDIT_STATUS = 2 or AUDIT_STATUS =3)
      </if>
      <if test="param.isstock != null and param.isstock != ''">
        and ISSTOCK = #{param.isstock,jdbcType=DECIMAL}
      </if>
      <if test="param.tag != null and param.tag != ''">
        and TAG LIKE '%'||#{param.tag,jdbcType=VARCHAR}||'%'
      </if>
      <if test="param.wartimeBegin != null">
        and WARTIME &gt;= #{param.wartimeBegin,jdbcType=TIMESTAMP}
      </if>
      <if test="param.wartimeEnd != null">
        and WARTIME &lt;= #{param.wartimeEnd,jdbcType=TIMESTAMP}
      </if>
      <if test="param.auditTimeBegin != null">
        and AUDIT_TIME &gt;= #{param.auditTimeBegin,jdbcType=TIMESTAMP}
      </if>
      <if test="param.auditTimeEnd != null">
        and AUDIT_TIME &lt;= #{param.auditTimeEnd,jdbcType=TIMESTAMP}
      </if>
      <if test="param.stockTimeBegin != null">
        and STOCK_TIME &gt;= #{param.stockTimeBegin,jdbcType=TIMESTAMP}
      </if>
      <if test="param.stockTimeEnd != null">
        and STOCK_TIME &lt;= #{param.stockTimeEnd,jdbcType=TIMESTAMP}
      </if>
      <if test="param.createTimeBegin != null">
        and CREATE_TIME &gt;= #{param.createTimeBegin,jdbcType=TIMESTAMP}
      </if>
      <if test="param.createTimeEnd != null">
        and CREATE_TIME &lt;= #{param.createTimeEnd,jdbcType=TIMESTAMP}
      </if>

      <choose>
        <when test="param.waraddr!='全部' and param.waraddr!=null">
          and WARADDR LIKE '%'||#{param.waraddr,jdbcType=VARCHAR} ||'%'
        </when>
        <when test="param.waraddr=='全部'">
          and WARADDR is not null
        </when>
      </choose>


      <choose>
        <when test="param.warnum!='全部' and param.warnum!=null ">
          and WARNUM LIKE '%'||#{param.warnum,jdbcType=VARCHAR}||'%'
        </when>
        <when test="param.warnum=='全部'">
          and WARNUM is not null
        </when>
      </choose>

      <choose>
        <when test="param.warstate!='全部' and param.warstate!=null ">
          and WARSTATE LIKE '%'||#{param.warstate,jdbcType=VARCHAR}||'%'
        </when>
        <when test="param.warstate=='全部'">
        and WARSTATE is not null
      </when>
      </choose>

      <!--<if test="param.content != null">
        and CONTENT = #{param.content,jdbcType=BLOB}
      </if>-->

      <choose>
        <when test="param.warstype!='全部' and param.warstype!=null">
          and WARSTYPE LIKE '%'||#{param.warstype,jdbcType=VARCHAR}||'%'
        </when>
        <when test="param.warstype=='全部'">
          and WARSTYPE is not null
        </when>

      </choose>

      <choose>
        <when test="param.corpstype!='全部' and param.corpstype!=null">
          and CORPSTYPE LIKE '%'||#{param.corpstype,jdbcType=VARCHAR}||'%'
        </when>
        <when test="param.corpstype=='全部'">
          and CORPSTYPE is not null
        </when>
      </choose>

      <if test="param.fightTime!=null and param.fightTime!=''">
        and FIGHTTIME =#{param.fightTime,jdbcType=VARCHAR}
      </if>
      <!--<choose>
        <when test="param.fightTime!=null">
          and FIGHTTIME =#{param.fightTime,jdbcType=VARCHAR}
        </when>
        <when test="param.fightTime=='全部'">
          and FIGHTTIME is not null
        </when>

      </choose>-->

      <choose>
        <when test="param.fighttype!='全部' and param.fighttype!=null">
          and FIGHTTYPE LIKE '%'||#{param.fighttype,jdbcType=VARCHAR}||'%'
        </when>
        <when test="param.fighttype=='全部'">
          and FIGHTTYPE is not null
        </when>

      </choose>

      <choose>
        <when test="param.combattypestring!='全部' and param.combattypestring!=null">
          and COMBATTYPE LIKE '%'||#{param.combattypestring,jdbcType=VARCHAR} ||'%'
        </when>
        <when test="param.combattypestring=='全部'">
          and COMBATTYPE is not null
        </when>
      </choose>

      <choose>
        <when test="param.fighttrait!='全部' and param.fighttrait!=null">
          and FIGHTTRAIT LIKE '%'||#{param.fighttrait,jdbcType=VARCHAR} ||'%'
        </when>
        <when test="param.fighttrait=='全部'">
          and FIGHTTRAIT is not null
        </when>
      </choose>


      <if test="param.docType !=null and param.docType>0">
        and DOCTYPE = #{param.docType,jdbcType=DECIMAL}
      </if>
      <if test="param.dirId != null">
        and d.ID in (select DOCUMENT_ID from PHOIBE_DOC_DIR where DIRECTORY_ID = #{param.dirId,jdbcType=DECIMAL})
      </if>
      <if test="param.contentStr != null and param.contentStr != ''">
        and d.ID in (select DOCUMENT_ID from PHOIBE_ATTACH_CONTENT where ATTACH_CONTENT LIKE '%'||#{param.contentStr,jdbcType=VARCHAR}||'%')
      </if>
      <if test="param.queryFlag != null and param.queryFlag == 'subscribe'">
        and d.USER_ID in (select SUB_USER_ID from PHOIBE_SUBSCRIBE where USER_ID = #{param.queryUserId,jdbcType=DECIMAL})
      </if>
      <if test="param.queryFlag != null and param.queryFlag == 'handpick'">
        and d.ID in (select t.DOCUMENT_ID from (select DOCUMENT_ID,ROWNUM rno from (select DOCUMENT_ID,count(DOCUMENT_ID) c from PHOIBE_COLLECTION group by DOCUMENT_ID order by c desc)) t)
      </if>
      <if test="param.formatArray != null">
        and FORMAT in
        <foreach collection="param.formatArray" index="index" item="item" open="(" separator="," close=")"  >
          #{item}
        </foreach>
      </if>


      <if test="param.warstateArray != null and param.warstateArray != ''">
        and (
              <foreach collection="param.warstateArray" index="index" item="item" separator="OR">
                 WARSTATE LIKE '%'||#{item}||'%'
              </foreach>
          )
      </if>

      <if test="param.waraddrArray != null and param.waraddrArray != ''">
        and (
        <foreach collection="param.waraddrArray" index="index" item="item" separator="OR">
          WARADDR LIKE '%'||#{item}||'%'
        </foreach>
        )
      </if>

      <if test="param.warstypeArray != null and param.warstypeArray != ''">
        and (
        <foreach collection="param.warstypeArray" index="index" item="item" separator="OR">
          WARSTYPE LIKE '%'||#{item}||'%'
        </foreach>
        )
      </if>

      <if test="param.corpstypeArray != null and param.corpstypeArray != ''">
        and (
        <foreach collection="param.corpstypeArray" index="index" item="item" separator="OR">
          CORPSTYPE LIKE '%'||#{item}||'%'
        </foreach>
        )
      </if>

      <if test="param.fighttypeArray != null and param.fighttypeArray != ''">
        and (
        <foreach collection="param.fighttypeArray" index="index" item="item" separator="OR">
          FIGHTTYPE LIKE '%'||#{item}||'%'
        </foreach>
        )
      </if>

      <if test="param.combattypestringArray != null and param.combattypestringArray != ''">
        and (
        <foreach collection="param.combattypestringArray" index="index" item="item" separator="OR">
          COMBATTYPE LIKE '%'||#{item}||'%'
        </foreach>
        )
      </if>

      <if test="param.fighttraitArray != null and param.fighttraitArray != ''">
        and (
        <foreach collection="param.fighttraitArray" index="index" item="item" separator="OR">
          FIGHTTRAIT LIKE '%'||#{item}||'%'
        </foreach>
        )
      </if>

    </where>
  </sql>
  <select id="selectByPage" parameterType="me.phoibe.doc.cms.domain.po.PageParam" resultMap="BaseResultMap">
    select * from (SELECT a.*,rownum rno FROM (
    select
    <include refid="Base_Column_List"/>
    from PHOIBE_DOCUMENT d
    <include refid="selectByPage_Condition_Sql"/>
    ORDER BY ${orderBy} ${sort}) a
    ) t WHERE t.rno BETWEEN (#{start}*#{limit}+1) AND (#{start}*#{limit}+#{limit})
  </select>

  <select id="selectCountByPage" parameterType="me.phoibe.doc.cms.domain.po.PageParam" resultType="long">
    select
    COUNT(*)
    from PHOIBE_DOCUMENT d
    <include refid="selectByPage_Condition_Sql"/>
  </select>

  <select id="selectDocumentUserCount" parameterType="me.phoibe.doc.cms.domain.po.PageParam" resultType="long">
    select
    COUNT(*)
    from PHOIBE_DOCUMENT d JOIN PHOIBE_USER u ON d.USER_ID = u.ID
    <include refid="selectByPage_Condition_Sql"/>

    <if test="param.nickname != null">
      and u.NICKNAME LIKE '%'||#{param.nickname,jdbcType=VARCHAR}||'%'
    </if>

    <if test="param.contentArray!= null">
      and d.ID in (select DOCUMENT_ID from PHOIBE_ATTACH_CONTENT where
      <foreach collection="param.contentArray" index="index" item="item" open="" separator=" OR " close=""  >
        ATTACH_CONTENT LIKE '%'||#{item}||'%'
      </foreach>
      )
    </if>
  </select>
  <select id="selectRelevantByPage" parameterType="me.phoibe.doc.cms.domain.po.PageParam" resultMap="BaseResultMap">
    select * from (SELECT a.*,rownum rno FROM (
    select
    <include refid="Base_Column_List"/>
    from PHOIBE_DOCUMENT d
      <where>
         1=1
           <!-- COMBAT_TYPE = #{param.combatType,jdbcType=DECIMAL}-->
            OR ARMS = #{param.arms,jdbcType=DECIMAL}
        <if test="param.tagArray != null and param.tagArray != ''">
          <foreach collection="param.tagArray" index="index" item="item">
            OR TAG LIKE '%'||#{item}||'%'
          </foreach>
        </if>
      </where>
      ORDER BY ${orderBy} ${sort}) a
    ) t WHERE t.rno BETWEEN (#{start}*#{limit}+1) AND (#{start}*#{limit}+#{limit})
  </select>

  <select id="selectRelevantCountByPage" parameterType="me.phoibe.doc.cms.domain.po.PageParam" resultType="long">
    select
    COUNT(*)
    from PHOIBE_DOCUMENT d
      <where>
        1=1
        <!--COMBAT_TYPE = #{param.combatType,jdbcType=DECIMAL}-->
        OR ARMS = #{param.arms,jdbcType=DECIMAL}
        <if test="param.tagArray != null and param.tagArray != ''">
          <foreach collection="param.tagArray" index="index" item="item">
            OR TAG LIKE '%'||#{item}||'%'
          </foreach>
        </if>
      </where>
  </select>
  <sql id="selectJoinByPage_Condition_Sql">
    <where>
      1=1
      <if test="param.name != null and param.name != ''">
        and NAME LIKE '%'||#{param.name,jdbcType=VARCHAR}||'%'
      </if>
      <if test="param.description != null and param.description != ''">
        and DESCRIPTION LIKE '%'||#{param.description,jdbcType=VARCHAR}||'%'
      </if>
      <if test="param.userId != null and param.userId != ''">
        and USER_ID = #{param.userId,jdbcType=DECIMAL}
      </if>
      <if test="param.format != null and param.format != ''">
        and FORMAT in ${param.format}
      </if>
      <if test="param.userRealName != null and param.userRealName != ''">
        and USER_REAL_NAME Like '%'||#{param.userRealName,jdbcType=VARCHAR}||'%'
      </if>
      <if test="param.score != null and param.score != ''">
        and SCORE = #{param.score,jdbcType=DECIMAL}
      </if>
      <!--<if test="param.combatType != null and param.arms != ''">
        and COMBAT_TYPE = #{param.combatType,jdbcType=DECIMAL}
      </if>-->
      <if test="param.arms != null and param.arms != ''">
        and ARMS = #{param.arms,jdbcType=DECIMAL}
      </if>
      <if test="param.status != null and param.tag != ''">
        and STATUS = #{param.status,jdbcType=DECIMAL}
      </if>
      <if test="param.auditStatus != null and param.tag != ''">
        and AUDIT_STATUS = #{param.auditStatus,jdbcType=DECIMAL}
      </if>
      <if test="param.isstock != null and param.tag != ''">
        and ISSTOCK = #{param.isstock,jdbcType=DECIMAL}
      </if>
      <if test="param.tag != null and param.tag != ''">
        and TAG LIKE '%'||#{param.tag,jdbcType=VARCHAR}||'%'
      </if>
      <if test="param.auditTimeBegin != null">
        and AUDIT_TIME &gt;= #{param.auditTimeBegin,jdbcType=TIMESTAMP}
      </if>
      <if test="param.auditTimeEnd != null">
        and AUDIT_TIME &lt;= #{param.auditTimeEnd,jdbcType=TIMESTAMP}
      </if>
      <if test="param.stockTimeBegin != null">
        and STOCK_TIME &gt;= #{param.stockTimeBegin,jdbcType=TIMESTAMP}
      </if>
      <if test="param.stockTimeEnd != null">
        and STOCK_TIME &lt;= #{param.stockTimeEnd,jdbcType=TIMESTAMP}
      </if>
      <if test="param.createTimeBegin != null">
        and CREATE_TIME &gt;= #{param.createTimeBegin,jdbcType=TIMESTAMP}
      </if>
      <if test="param.createTimeEnd != null">
        and CREATE_TIME &lt;= #{param.createTimeEnd,jdbcType=TIMESTAMP}
      </if>
      <!--<if test="param.warnumBegin != null">
        and WARNUM &gt;= #{param.warnumBegin,jdbcType=DECIMAL}
      </if>
      <if test="param.warnumEnd != null">
        and WARNUM &lt;= #{param.warnumEnd,jdbcType=DECIMAL}
      </if>-->
      <if test="param.dirId != null">
        and d.ID in (select DOCUMENT_ID from PHOIBE_DOC_DIR where DIRECTORY_ID = #{param.dirId,jdbcType=DECIMAL})
      </if>
      <if test="param.contentStr != null and param.contentStr != ''">
        and d.ID in (select DOCUMENT_ID from PHOIBE_ATTACH_CONTENT where ATTACH_CONTENT LIKE '%'||#{param.contentStr,jdbcType=VARCHAR}||'%')
      </if>
    </where>
  </sql>

  <select id="selectJoinByPage" parameterType="me.phoibe.doc.cms.domain.po.PageParam" resultMap="BaseResultMap">
    select * from (
    select
    d.*,u.NICKNAME,rownum rno
    from PHOIBE_DOCUMENT d
    <if test="param.queryFlag != null and param.queryFlag == 'browse'">
      join (select d.ID
      from PHOIBE_DOCUMENT d
      join PHOIBE_BROWSE b on d.ID = b.DOCUMENT_ID and b.USER_ID = #{param.queryUserId,jdbcType=DECIMAL}
      <include refid="selectJoinByPage_Condition_Sql"/>
      group by d.ID
      ORDER BY max(b.CREATE_TIME) DESC) a on d.ID = a.ID
    </if>
    <!--<if test="param.queryFlag != null and param.queryFlag == 'collection'">
      join PHOIBE_COLLECTION c on d.ID = c.DOCUMENT_ID and c.USER_ID = #{param.queryUserId,jdbcType=DECIMAL}
      <include refid="selectJoinByPage_Condition_Sql"/>
      order by c.CREATE_TIME desc
    </if>-->
    <if test="param.queryFlag != null and param.queryFlag == 'collection'">
    join (select d.ID
    from PHOIBE_DOCUMENT d
    join PHOIBE_COLLECTION b on d.ID = b.DOCUMENT_ID and b.USER_ID = #{param.queryUserId,jdbcType=DECIMAL}
    <include refid="selectJoinByPage_Condition_Sql"/>
    group by d.ID
    ORDER BY max(b.CREATE_TIME) DESC) a on d.ID = a.ID
    </if>
      join PHOIBE_USER u on u.id=d.USER_ID
    ) t WHERE t.rno BETWEEN (#{start}*#{limit}+1) AND (#{start}*#{limit}+#{limit})
  </select>

  <select id="selectJoinCountByPage" parameterType="me.phoibe.doc.cms.domain.po.PageParam" resultType="long">
    select
    count(*)
    from PHOIBE_DOCUMENT d
    <if test="param.queryFlag != null and param.queryFlag == 'browse'">
      join (select d.ID
      from PHOIBE_DOCUMENT d
      join PHOIBE_BROWSE b on d.ID = b.DOCUMENT_ID and b.USER_ID = #{param.queryUserId,jdbcType=DECIMAL}
      <include refid="selectJoinByPage_Condition_Sql"/>
      group by d.ID
      ORDER BY max(b.CREATE_TIME) DESC) a on d.ID = a.ID
    </if>
    <if test="param.queryFlag != null and param.queryFlag == 'collection'">
      join PHOIBE_COLLECTION c on d.ID = c.DOCUMENT_ID and c.USER_ID = #{param.queryUserId,jdbcType=DECIMAL}
      <include refid="selectJoinByPage_Condition_Sql"/>
    </if>

  </select>

  <select id="selectDocumentUser" parameterType="me.phoibe.doc.cms.domain.po.PageParam" resultType="me.phoibe.doc.cms.domain.dto.DPhoebeDocument">
    select * from (SELECT a.*,rownum rno FROM (
    select d.ID, NAME, FORMAT, USER_ID userId, SCORE,
    FILE_PATH filePath, FILE_SIZE fileSize,ARMS, d.STATUS, AUDIT_STATUS auditStatus, AUDIT_USER_ID auditUserId,
    PROGRESS, TAG, DESCRIPTION, d.CREATE_TIME createTime, d.UPDATE_TIME updateTime,PAGECOUNT,AUDIT_TIME auditTime,ISSTOCK,STOCK_TIME stockTime,STOCKER,USER_NAME userName, TYPE,
    REALNAME,NICKNAME,USER_REAL_NAME userRealName,WARSTATE warstate,WARADDR warsaddr,AUDITOR auditor,AUDITDESC auditDesc
    from PHOIBE_DOCUMENT d JOIN PHOIBE_USER u ON d.USER_ID = u.ID
    <include refid="selectByPage_Condition_Sql"/>

    <if test="param.nickname != null">
      and u.NICKNAME LIKE '%'||#{param.nickname,jdbcType=VARCHAR}||'%'
    </if>

    <!--<if test="param.combatTypeString!=null">
      and d.COMBATTYPE  LIKE '%'||#{param.combatTypeString,jdbcType=VARCHAR}||'%'
    </if>

    <if test="param.corpstype!=null">
      and d.CORPSTYPE  LIKE '%'||#{param.corpstype,jdbcType=VARCHAR}||'%'
    </if>
    <if test="param.fighttrait!=null">
      and d.FIGHTTRAIT  LIKE '%'||#{param.fighttrait,jdbcType=VARCHAR}||'%'
    </if>
    <if test="param.combatTypeString!=null">
      and d.COMBATTYPE  LIKE '%'||#{param.combatTypeString,jdbcType=VARCHAR}||'%'
    </if>
-->
    <if test="param.contentArray!= null">
      and d.ID in (select DOCUMENT_ID from PHOIBE_ATTACH_CONTENT where
      <foreach collection="param.contentArray" index="index" item="item" open="" separator=" OR " close=""  >
        ATTACH_CONTENT LIKE '%'||#{item}||'%'
      </foreach>
      )
    </if>

    ORDER BY d.CREATE_TIME DESC nulls last) a
    ) t WHERE t.rno BETWEEN (#{start}*#{limit}+1) AND (#{start}*#{limit}+#{limit})
  </select>

  <update id="updateHitcountById" parameterType="long">
    update PHOIBE_DOCUMENT SET HITCOUNT = HITCOUNT+1 WHERE ID = #{documentId,jdbcType=DECIMAL}
  </update>

  <select id="selectAvgScore" parameterType="long" resultType="double">
    select avg(SCORE) from PHOIBE_DOCUMENT d where USER_ID = #{userId,jdbcType=DECIMAL}
  </select>
  <select id="selectStatisticalByParam" parameterType="string" resultType="me.phoibe.doc.cms.domain.dto.DStatistical">
    select di.id id,di.DICT_NAME name,count(d.ID) count from PHOIBE_DOCUMENT d
    <if test="_parameter == 'COMBAT'">
      join PHOIBE_DICT di on d.COMBAT_TYPE = di.ID where di.GROUP_KEY = #{_parameter,jdbcType=VARCHAR}
    </if>
    <if test="_parameter == 'SOLDIERS'">
      join PHOIBE_DICT di on d.ARMS = di.ID where di.GROUP_KEY = #{_parameter,jdbcType=VARCHAR}
    </if>
     GROUP BY di.DICT_NAME,di.id
  </select>
</mapper>